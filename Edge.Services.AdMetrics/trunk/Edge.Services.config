<?xml version="1.0" encoding="utf-8" ?>
<configuration>
	<configSections>
		<section name="edge.services" type="Edge.Core.Configuration.EdgeServicesConfiguration, Edge.Core" />
	</configSections>

	<appSettings>
		<add key="Edge.Data.Pipeline.FileManager.RootPath" value="D:\Runtime\Edge\Edge.Data.Pipeline.FileManager"/>
		<add key="Edge.Data.Pipeline.FileManager.BufferSize" value="20"/>
		<add key="Edge.Data.Pipeline.Delivery.Db4o.FileName" value="Edge.Deliveries.db4o"/>
		<add key="Edge.Data.Pipeline.Delivery.Db4o.Port" value="2121"/>
		<add key="Edge.Data.Pipeline.Delivery.Db4o.User" value="sa"/>
		<add key="Edge.Data.Pipeline.Delivery.Db4o.Password" value="sa"/>
		<add key="Edge.Data.Objects.Measure.GetMeasures.SP" value="Measure_GetMeasures(@accountID:Int,@channelID:Int,@flags:int,@operator:int"/>
		<add key="Edge.Services.AdMetrics.AdMetricsImportManager.BufferSize" value="10"/>
	</appSettings>

	<connectionStrings>
		<add name="Edge.Data.Pipeline.Delivery.DB" connectionString="Host=localhost; User=sa; Password=sa; Port=2121;"/>
		<add name="Edge.Core.Services.SystemDatabase" connectionString="Data Source=localhost; Database=Edge_System; Integrated Security=SSPI;"/>
		<add name="Edge.Data.Pipeline.Delivery.Sql.DeliveriesDb" connectionString="Data Source=alonya-pc; Database=Deliveries;Integrated Security=false;User ID=sa;PWD=Iuh2sstd"/>
		<add name="Edge.Services.AdMetrics.AdMetricsImportManager.Oltp" connectionString="Data Source=alonya-pc; Database=testdb;Integrated Security=false;User ID=sa;PWD=Iuh2sstd"/>
		<add name="Edge.Services.AdMetrics.ValidateCommitService.OLTP" connectionString="Data Source=alonya-pc; Database=testdb;Integrated Security=false;User ID=sa;PWD=Iuh2sstd"/>
	</connectionStrings>

	<edge.services>
		<Extensions>
			<add key="AutoSegments" value="Edge.Data.Pipeline.Configuration.AutoSegmentDefinitionCollection, Edge.Data.Pipeline"/>
		</Extensions>

		<Services>
			

		</Services>

		<Accounts>
			<Account ID="7" Name="OOVOO">
				<ImportMappings>
					<Map To="Ad.Campaign.Channel.Name" Field="Channel"/>
					
					<Map To="Ad.Campaign.Account.Name" Field="AccountName"/>
					
					<Map To="Ad.Campaign.Name" Field="Campaign"/>

					<Map To="Ad.Campaign">
						<Read Name="cc" Field="Channel"/>
						
						<Map To="Channel.Name" Value="{cc}"/>
						
						<Map To="Channel">
							<Map To="Name" Field="Channel"/>
						</Map>
						
						<Map To="Account">
							<Read Field="AccountName" Name="anm" Regex="(?{chicken}[A-Z]*)"/>
							<Map To="Name" Value="{anm.chicken}"/>
						</Map>
					</Map>
					
					<Map To="Ad.DestinationUrl" Field="destUrl"/>
					
					<Map To="Ad.Creatives[]::TextCreative">
						<Read Field="Desc1"/>
						<Read Field="Desc2"/>
						<Map To="TextType" Value="Body"/>
						<Map To="Text" Value="{Desc1}"/>
						<Map To="Text2" Value="{Desc2}"/>
					</Map>
					
					<Map To="Ad.Creatives[]::TextCreative" Field="creativeVisurl">
						<Map To="TextType" Value="DisplayUrl"/>
						<Map To="Text" Value="{creativeVisurl}"/>
					</Map>
					
					<Map To="Ad.Segments[Segment:AdGroup]::SegmentValue" Field="Adgroup">
						<Map To="Value" Value="{Adgroup}"/>
					</Map>
					
					<Map To="Ad.Segments[Segment:Tracker]::SegmentValue" Field="destUrl" Regex="\butm_content=(?{utm_content}\w+)\b">
						<Map To="Value" Value="{utm_content}"/>
					</Map>

					<Map>
						<Source>
							<From Field="DayCode" Regex="(?{y}[0-9]{4})(?{m}[0-9]{2})(?{d}[0-9]{2})"/>
						</Source>
						<To>
							<Map To="AdMetricsUnit.PeriodStart" Value="{date:{y}-{m}-{d}, boundary: 'lower'}"/>
							<Map To="AdMetricsUnit.PeriodEnd" Value="{date:{y}-{m}-{d}, boundary: 'upper'}"/>
						</To>
					</Map>
					
					<Map To="AdMetricsUnit.TargetsMatches[]" Field="Keyword">
						<Apply New="KeywordTarget">
							<To Property="Keyword" Value="{Keyword}"/>
						</Apply>
					</Map>
					
					<Map To="AdMetricsUnit.Measures[Measure:Impressions]" Field="Imps"/>
					<Map To="AdMetricsUnit.Measures[Measure:Clicks]" Field="Clicks"/>
					<Map To="AdMetricsUnit.Measures[Measure:Cost]" Field="Cost"/>
				</ImportMappings>
			</Account>
		</Accounts>
	</edge.services>

</configuration>