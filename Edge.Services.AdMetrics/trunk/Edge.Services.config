<?xml version="1.0" encoding="utf-8" ?>
<configuration>
	<configSections>
		<section name="edge.services" type="Edge.Core.Configuration.EdgeServicesConfiguration, Edge.Core" />
	</configSections>

	<appSettings>
		<add key="Edge.Data.Pipeline.FileManager.RootPath" value="D:\Runtime\Edge\Edge.Data.Pipeline.FileManager"/>
		<add key="Edge.Data.Pipeline.FileManager.BufferSize" value="20"/>
		<add key="Edge.Data.Pipeline.Delivery.Db4o.FileName" value="Edge.Deliveries.db4o"/>
		<add key="Edge.Data.Pipeline.Delivery.Db4o.Port" value="2121"/>
		<add key="Edge.Data.Pipeline.Delivery.Db4o.User" value="sa"/>
		<add key="Edge.Data.Pipeline.Delivery.Db4o.Password" value="sa"/>
		<add key="Edge.Data.Objects.Measure.GetMeasures.SP" value="Measure_GetMeasures(@accountID:Int,@channelID:Int,@flags:int,@operator:int"/>
		<add key="Edge.Services.AdMetrics.AdMetricsImportManager.BufferSize" value="10"/>
	</appSettings>

	<connectionStrings>
		<add name="Edge.Data.Pipeline.Delivery.DB" connectionString="Host=localhost; User=sa; Password=sa; Port=2121;"/>
		<add name="Edge.Core.Services.SystemDatabase" connectionString="Data Source=localhost; Database=Edge_System; Integrated Security=SSPI;"/>
		<add name="Edge.Data.Pipeline.Delivery.Sql.DeliveriesDb" connectionString="Data Source=alonya-pc; Database=Deliveries;Integrated Security=false;User ID=sa;PWD=Iuh2sstd"/>
		<add name="Edge.Services.AdMetrics.AdMetricsImportManager.Oltp" connectionString="Data Source=alonya-pc; Database=testdb;Integrated Security=false;User ID=sa;PWD=Iuh2sstd"/>
		<add name="Edge.Services.AdMetrics.ValidateCommitService.OLTP" connectionString="Data Source=alonya-pc; Database=testdb;Integrated Security=false;User ID=sa;PWD=Iuh2sstd"/>
	</connectionStrings>

	<edge.services>
		<Extensions>
			<add key="AutoSegments" value="Edge.Data.Pipeline.Configuration.AutoSegmentDefinitionCollection, Edge.Data.Pipeline"/>
		</Extensions>

		<Services>
			

		</Services>

		<Accounts>
			<Account ID="7" Name="OOVOO">
				<ImportMappings>
					
					<Map To="Ad.Campaign.Channel.Name" Field="Channel"/>
					<Map To="Ad.Campaign.Account.Name" Field="AccountName"/>
					<Map To="Ad.Campaign.Name" Field="Campaign"/>
					<Map To="Ad.DestinationUrl" Field="destUrl"/>
					<Map To="Ad.Creatives[]">
						<Extract>
							<From Field="Desc1"/>
							<From Field="Desc2"/>
						</Extract>
						<Apply New="TextCreative">
							<To Property="TextType" Value="Body"/>
							<To Property="Text" Value="{Desc1}"/>
							<To Property="Text2" Value="{Desc2}"/>
						</Apply>
					</Map>
					<Map To="Ad.Creatives[]">
						<Apply New="TextCreative">
							<To Property="TextType" Value="DisplayUrl"/>
							<To Property="Text" Field="creativeVisurl"/>
						</Apply>
					</Map>
					<Map To="Ad.Segments[Segment:AdGroup]" Field="Adgroup">
						<Apply New="SegmentValue">
							<To Property="Value" Value="{Adgroup}"/>
						</Apply>
					</Map>
					<Map To="Ad.Segments[Segment:Tracker]" Field="destUrl" Regex="\butm_content=(?{utm_content}\w+)\b">
						<Apply New="SegmentValue">
							<To Property="Value" Value="{utm_content}"/>
						</Apply>
					</Map>

					<Map>
						<Extract>
							<From Field="DayCode" Regex="(?{y}[0-9]{4})(?{m}[0-9]{2})(?{d}[0-9]{2})"/>
						</Extract>
						<Apply>
							<To Property="AdMetricsUnit.PeriodStart" Value="{date:{y}-{m}-{d}, boundary: 'lower'}"/>
							<To Property="AdMetricsUnit.PeriodEnd" Value="{date:{y}-{m}-{d}, boundary: 'upper'}"/>
						</Apply>
					</Map>
					<Map To="AdMetricsUnit.TargetsMatches[]" Field="Keyword">
						<Apply New="KeywordTarget">
							<To Property="Keyword" Value="{Keyword}"/>
						</Apply>
					</Map>
					<Map To="AdMetricsUnit.Measures[Measure:Impressions]" Field="Imps"/>
					<Map To="AdMetricsUnit.Measures[Measure:Clicks]" Field="Clicks"/>
					<Map To="AdMetricsUnit.Measures[Measure:Cost]" Field="Cost"/>
				</ImportMappings>
			</Account>
		</Accounts>
	</edge.services>

</configuration>